<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover"/>
<title>ìš°ë¦¬ë“¤ì˜ ì´ì•¼ê¸°</title>

<link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/orioncactus/pretendard/dist/web/variable/pretendardvariable.css">

<style>
  :root{
    --bg: #0f0d0c;
    --text: #f5f5f5;
    --muted: rgba(245,245,245,0.72);
    --accent: #ff4d6d;
    --shadow: 0 18px 60px rgba(0,0,0,.45);
    --radius: 16px;
    --vh: 1vh; /* JSì—ì„œ ì‹¤ì œ í™”ë©´ ë†’ì´ë¡œ ê°±ì‹  */
  }

  *{ box-sizing:border-box; }

  body{
    margin:0;
    font-family:"Pretendard Variable", system-ui, -apple-system, BlinkMacSystemFont;
    background:
      radial-gradient(1200px 600px at 50% 70%, rgba(255,77,109,0.18), transparent 60%),
      radial-gradient(800px 500px at 30% 20%, rgba(255,143,171,0.14), transparent 60%),
      var(--bg);
    color: var(--text);
    overflow:hidden;
    touch-action: manipulation;
  }

  /* í˜ì´ì§€: ì£¼ì†Œì°½/íˆ´ë°” í¬í•¨ vh ì˜¤ì°¨ ë°©ì§€ */
  .page{
    position:absolute;
    inset:0;
    height: calc(var(--vh) * 100);
    display:flex;
    flex-direction:column;
    align-items:center;
    justify-content:center;
    gap:8px;
    padding: 10px 12px 62px; /* í•˜ë‹¨ ë²„íŠ¼ ê³µê°„(ìŠ¬ë¦¼) */
    opacity:0;
    transform: translateY(8px) scale(0.985);
    transition: opacity .55s ease, transform .55s ease;
  }
  .page.active{
    opacity:1;
    transform: translateY(0) scale(1);
    z-index:2;
  }

  /* í”„ë ˆì„: ê·¸ë¦¼ì´ ì£¼ì¸ê³µ */
  .frame{
    width: min(1020px, 98vw);
    height: min(calc(var(--vh) * 88), 84vh);
    display:flex;
    align-items:center;
    justify-content:center;
    background: linear-gradient(180deg, rgba(255,255,255,0.06), rgba(255,255,255,0.025));
    border: 1px solid rgba(255,255,255,0.10);
    border-radius: var(--radius);
    box-shadow: var(--shadow);
    overflow:hidden;
  }

  img{
    width: 100%;
    height: 100%;
    object-fit: contain;
    display:block;
  }

  /* ìƒë‹¨ ì œëª©: ê³µê°„ ìµœì†Œ */
  .title{
    font-weight: 800;
    letter-spacing: -0.03em;
    text-align:center;
    font-size: 13px;
    color: var(--muted);
    margin: 0 0 2px;
    line-height: 1.1;
  }

  /* ê°€ë¡œëª¨ë“œì—ì„œ ì œëª© ë” ì‘ê²Œ(ê±°ì˜ ë°°ê²½) */
  @media (orientation: landscape){
    .title{
      font-size: 12px;
      opacity: 0.6;
      margin-bottom: 2px;
    }
  }

  /* í”„ëŸ¬í¬ì¦ˆ ë¬¸êµ¬ */
  .question{
    font-weight: 950;
    letter-spacing: -0.04em;
    text-align:center;
    line-height: 1.1;
    margin: 0 0 4px;
    font-size: 22px;
  }
  @media (orientation: landscape){
    .question{ font-size: 22px; }
  }

  /* í•˜ë‹¨ ë„¤ë¹„: í•œ ì¤„ ì–‡ê²Œ */
  .bottom-nav{
    position:fixed;
    left:0;
    right:0;
    bottom: max(6px, env(safe-area-inset-bottom));
    display:flex;
    justify-content:center;
    gap:8px;
    padding: 6px 10px;
    z-index:50;
    pointer-events:none;
  }

  .nav-btn, .start-btn, .yes-btn{
    pointer-events:auto;
    border:none;
    border-radius: 999px;
    font-weight: 900;
    letter-spacing: -0.02em;
    cursor:pointer;
    user-select:none;
    -webkit-tap-highlight-color: transparent;
  }

  .nav-btn{
    padding: 8px 14px;
    font-size: 13px;
    background: rgba(255,255,255,0.82);
    color: #141414;
    opacity: 0.75; /* ëœ íŠ€ê²Œ */
  }
  .nav-btn:disabled{
    opacity: .35;
    cursor:not-allowed;
  }

  .start-btn, .yes-btn{
    padding: 10px 26px;
    font-size: 15px;
    background: var(--accent);
    color: white;
    box-shadow: 0 12px 28px rgba(255,77,109,.30);
  }

  /* Yes ë²„íŠ¼ ë°˜ë³µ í´ë¦­ ìœ ë„(ì€ì€í•˜ê²Œ) */
  .yes-btn.pulse{
    animation: pulse 1.5s ease-in-out infinite;
  }
  @keyframes pulse{
    0%,100%{ transform:scale(1); }
    50%{ transform:scale(1.03); }
  }

  /* ê½ƒì */
  .petals{
    position:fixed;
    inset:0;
    pointer-events:none;
    z-index:200;
  }
  .petal{
    position:absolute;
    top:-10vh;
    font-size:22px;
    filter: drop-shadow(0 8px 14px rgba(0,0,0,.25));
    animation: fall linear forwards;
    will-change: transform, opacity;
  }
  @keyframes fall{
    0%   { transform: translate3d(var(--x), -10vh, 0) rotate(0deg); opacity:0; }
    10%  { opacity:1; }
    100% { transform: translate3d(calc(var(--x) + var(--drift)), 110vh, 0) rotate(var(--rot)); opacity:1; }
  }

  /* ì„¸ë¡œëª¨ë“œì—ì„œëŠ” ê°€ë¡œ ìµœì í™” ì•ˆë‚´ë¥¼ ì•„ì£¼ ì‘ê²Œë§Œ */
  @media (orientation: portrait){
    .title{ opacity: .45; }
    .frame{ height: min(calc(var(--vh) * 78), 72vh); }
  }
</style>

<script>
  // ì‹¤ì œ í™”ë©´ ë†’ì´ë¡œ vh ë³´ì • (ì£¼ì†Œì°½/íˆ´ë°” ì˜í–¥ ìµœì†Œí™”)
  function setVH(){
    const vh = window.innerHeight * 0.01;
    document.documentElement.style.setProperty('--vh', `${vh}px`);
  }
  window.addEventListener('resize', setVH);
  window.addEventListener('orientationchange', () => setTimeout(setVH, 200));
  setVH();
</script>
</head>

<body>
<!-- ë°°ê²½ìŒì•… -->
<audio id="bgm" src="music.mp3" loop></audio>
<!-- í­ì£½ íš¨ê³¼ìŒ (BGM ëŠê¹€ ì—†ì´ ê²¹ì³ ì¬ìƒ) -->
<audio id="sfx" src="firework.mp3" preload="auto"></audio>

<!-- 1: í‘œì§€ -->
<div class="page active">
  <h1 class="title">ìš°ë¦¬ë“¤ì˜ ì´ì•¼ê¸°</h1>
  <div class="frame"><img src="1.png" alt="cover"></div>
  <button class="start-btn" onclick="nextPage()">ì‹œì‘í•˜ê¸°</button>
</div>

<!-- 2~5 -->
<div class="page"><div class="frame"><img src="2.png" alt="p2"></div></div>
<div class="page"><div class="frame"><img src="3.png" alt="p3"></div></div>
<div class="page"><div class="frame"><img src="4.png" alt="p4"></div></div>
<div class="page"><div class="frame"><img src="5.png" alt="p5"></div></div>

<!-- 6: ë§ˆì§€ë§‰(í”„ëŸ¬í¬ì¦ˆ) -->
<div class="page">
  <h2 class="question">ë‚˜ì™€ ê²°í˜¼í•´ì¤„ë˜? ğŸ’ğŸ’</h2>
  <div class="frame"><img src="6.png" alt="proposal"></div>
  <button id="yesBtn" class="yes-btn pulse" onclick="celebrate()">Yes!</button>
</div>

<!-- í•˜ë‹¨ ì´ì „/ë‹¤ìŒ (ìŠ¬ë¦¼) -->
<div class="bottom-nav">
  <button id="prevBtn" class="nav-btn" onclick="prevPage()" disabled>ì´ì „</button>
  <button id="nextBtn" class="nav-btn" onclick="nextPage()">ë‹¤ìŒ</button>
</div>

<div id="petals" class="petals"></div>

<script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.9.3/dist/confetti.browser.min.js"></script>
<script>
  const pages = document.querySelectorAll('.page');
  const prevBtn = document.getElementById('prevBtn');
  const nextBtn = document.getElementById('nextBtn');
  const petalsLayer = document.getElementById('petals');
  const bgm = document.getElementById('bgm');
  const sfx = document.getElementById('sfx');

  let current = 0;

  // ì²« í„°ì¹˜: BGM ì‹œì‘ + SFX ì›Œë°ì—… + ì£¼ì†Œì°½ ìˆ¨ê¹€ ì‹œë„
  document.body.addEventListener('pointerdown', async () => {
    if (bgm.paused) bgm.play().catch(()=>{});
    try {
      await sfx.play();
      sfx.pause();
      sfx.currentTime = 0;
    } catch(e) {}
    setTimeout(() => window.scrollTo(0, 1), 120);
  }, { once: true });

  function updateNav(){
    prevBtn.disabled = current === 0;
    nextBtn.style.display = (current === pages.length - 1) ? 'none' : 'inline-block';
  }

  function showPage(i){
    pages[current].classList.remove('active');
    current = i;
    pages[current].classList.add('active');
    updateNav();
    setTimeout(() => window.scrollTo(0, 1), 80);
  }

  function nextPage(){ if(current < pages.length - 1) showPage(current + 1); }
  function prevPage(){ if(current > 0) showPage(current - 1); }

  function dropFlowers(count = 44){
    const symbols = ["ğŸŒ¸","ğŸŒ·","ğŸ’","ğŸŒº","ğŸŒ¼"];
    const w = window.innerWidth;

    for(let i=0;i<count;i++){
      const el = document.createElement('span');
      el.className = 'petal';
      el.textContent = symbols[Math.floor(Math.random()*symbols.length)];

      const x = Math.floor(Math.random() * w);
      const drift = (Math.random() * 300 - 150).toFixed(0) + "px";
      const rot = (Math.random() * 720 - 360).toFixed(0) + "deg";
      const dur = (Math.random() * 2.2 + 2.8).toFixed(2) + "s";
      const delay = (Math.random() * 0.22).toFixed(2) + "s";
      const size = (Math.random() * 14 + 18).toFixed(0) + "px";

      el.style.setProperty('--x', x + "px");
      el.style.setProperty('--drift', drift);
      el.style.setProperty('--rot', rot);
      el.style.animationDuration = dur;
      el.style.animationDelay = delay;
      el.style.fontSize = size;

      petalsLayer.appendChild(el);
      el.addEventListener('animationend', ()=> el.remove());
    }
  }

  function fireworks(){
    confetti({ particleCount: 110, spread: 95, startVelocity: 52, origin: { y: 0.62 }});
    confetti({ particleCount: 70,  spread: 85, startVelocity: 46, origin: { x: 0.18, y: 0.68 }});
    confetti({ particleCount: 70,  spread: 85, startVelocity: 46, origin: { x: 0.82, y: 0.68 }});
  }

  function playSfxFresh(){
    try{
      sfx.pause();
      sfx.currentTime = 0;
      sfx.volume = 0.95;
      sfx.play();
    }catch(e){}
  }

  // Yes ë°˜ë³µ í´ë¦­: ë§¤ë²ˆ í­ì£½+ê½ƒ+íš¨ê³¼ìŒ ê°±ì‹ 
  function celebrate(){
    playSfxFresh();
    fireworks();
    dropFlowers(44);
  }

  updateNav();

  // PC í…ŒìŠ¤íŠ¸ìš©
  window.addEventListener('keydown', (e)=>{
    if(e.key === 'ArrowRight') nextPage();
    if(e.key === 'ArrowLeft') prevPage();
  });
</script>
</body>
</html>