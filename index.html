<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
<title>í˜•ì¤€ì´ì™€ í˜œë¹ˆì´ì˜ ì´ì•¼ê¸°</title>

<link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/orioncactus/pretendard/dist/web/variable/pretendardvariable.css">

<style>
  body{
    margin:0;
    font-family:"Pretendard Variable", system-ui, -apple-system, BlinkMacSystemFont;
    background:#fdf6f0;
    overflow:hidden;
    color:#2b2b2b;
  }

  .page{
    position:absolute;
    inset:0;
    display:flex;
    flex-direction:column;
    align-items:center;
    justify-content:center;
    gap:18px;
    padding:20px;
    opacity:0;
    transform:scale(0.97);
    transition:.6s ease;
  }
  .page.active{
    opacity:1;
    transform:scale(1);
    z-index:2;
  }

  img{
    max-width:90%;
    max-height:75vh;
    border-radius:16px;
    box-shadow:0 14px 40px rgba(0,0,0,.15);
  }

  /* í•˜ë‹¨ ì´ì „/ë‹¤ìŒ */
  .bottom-nav{
    position:fixed;
    bottom:20px;
    left:0;
    right:0;
    display:flex;
    justify-content:center;
    gap:12px;
    z-index:50;
  }
  .nav-btn{
    padding:12px 22px;
    border:none;
    border-radius:999px;
    font-size:16px;
    font-weight:700;
    background:#ffffffcc;
    backdrop-filter:blur(6px);
    cursor:pointer;
  }
  .nav-btn:disabled{
    opacity:.4;
    cursor:not-allowed;
  }

  .start-btn,
  .yes-btn{
    padding:16px 42px;
    font-size:22px;
    font-weight:900;
    border:none;
    border-radius:999px;
    background:#ff4d6d;
    color:white;
    cursor:pointer;
    box-shadow:0 14px 34px rgba(255,77,109,.3);
  }

  .question{
    text-align:center;
    font-size:clamp(26px,5vw,40px);
    font-weight:900;
    line-height:1.15;
  }

  /* ê½ƒì ë ˆì´ì–´ */
  .petals{
    position:fixed;
    inset:0;
    pointer-events:none;
    z-index:200;
  }
  .petal{
    position:absolute;
    top:-10vh;
    font-size:22px;
    filter: drop-shadow(0 6px 10px rgba(0,0,0,.12));
    animation:fall linear forwards;
    will-change: transform;
  }
  @keyframes fall{
    0%   { transform: translate3d(var(--x), -10vh, 0) rotate(0deg); opacity:0; }
    10%  { opacity:1; }
    100% { transform: translate3d(calc(var(--x) + var(--drift)), 110vh, 0) rotate(var(--rot)); opacity:1; }
  }

  /* Yes í›„ ë²„íŠ¼ ìŠ¤íƒ€ì¼ */
  .yes-btn.done{
    background:#ff8fab;
    box-shadow:none;
  }
</style>
</head>

<body>
<!-- ë°°ê²½ìŒì•… -->
<audio id="bgm" src="music.mp3" loop></audio>
<!-- í­ì£½ íš¨ê³¼ìŒ (BGM ëŠê¹€ ì—†ì´ ê²¹ì³ ì¬ìƒ) -->
<audio id="sfx" src="firework.mp3" preload="auto"></audio>

<!-- 1: í‘œì§€ -->
<div class="page active">
  <img src="1.png" alt="cover">
  <button class="start-btn" onclick="nextPage()">ì‹œì‘í•˜ê¸°</button>
</div>

<!-- 2~5 -->
<div class="page"><img src="2.png" alt="p2"></div>
<div class="page"><img src="3.png" alt="p3"></div>
<div class="page"><img src="4.png" alt="p4"></div>
<div class="page"><img src="5.png" alt="p5"></div>

<!-- 6: ë§ˆì§€ë§‰(í”„ëŸ¬í¬ì¦ˆ) -->
<div class="page">
  <div class="question">ë‚˜ì™€ ê²°í˜¼í•´ì¤„ë˜? ğŸ’ğŸ’</div>
  <img src="6.png" alt="proposal">
  <button id="yesBtn" class="yes-btn" onclick="yes()">Yes!</button>
</div>

<!-- í•˜ë‹¨ ì´ì „/ë‹¤ìŒ -->
<div class="bottom-nav">
  <button id="prevBtn" class="nav-btn" onclick="prevPage()" disabled>ì´ì „</button>
  <button id="nextBtn" class="nav-btn" onclick="nextPage()">ë‹¤ìŒ</button>
</div>

<div id="petals" class="petals"></div>

<!-- í­ì£½(ì»¨í˜í‹°) -->
<script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.9.3/dist/confetti.browser.min.js"></script>
<script>
  const pages = document.querySelectorAll('.page');
  const prevBtn = document.getElementById('prevBtn');
  const nextBtn = document.getElementById('nextBtn');
  const petalsLayer = document.getElementById('petals');
  const bgm = document.getElementById('bgm');
  const sfx = document.getElementById('sfx');
  const yesBtn = document.getElementById('yesBtn');

  let current = 0;

  // ëª¨ë°”ì¼ ìë™ì¬ìƒ ì œí•œ ëŒ€ì‘:
  // ì²« í„°ì¹˜ì—ì„œ BGM ì¬ìƒ + SFX ê¶Œí•œ ì›Œë°ì—…(ì ê¹ ì¬ìƒí–ˆë‹¤ê°€ ë©ˆì¶¤)
  document.body.addEventListener('pointerdown', async () => {
    if (bgm.paused) bgm.play().catch(()=>{});

    // SFX ì¬ìƒ ê¶Œí•œ í™•ë³´ìš©(ì†Œë¦¬ ì•ˆ ë‚˜ë„ ì •ìƒ)
    try {
      await sfx.play();
      sfx.pause();
      sfx.currentTime = 0;
    } catch(e) {}
  }, { once: true });

  function updateNav(){
    prevBtn.disabled = current === 0;
    nextBtn.style.display = (current === pages.length - 1) ? 'none' : 'inline-block';
  }

  function showPage(i){
    pages[current].classList.remove('active');
    current = i;
    pages[current].classList.add('active');
    updateNav();
  }

  function nextPage(){ if(current < pages.length - 1) showPage(current + 1); }
  function prevPage(){ if(current > 0) showPage(current - 1); }

  function dropFlowers(count = 40){
    const symbols = ["ğŸŒ¸","ğŸŒ·","ğŸ’","ğŸŒº","ğŸŒ¼"];
    const w = window.innerWidth;

    for(let i=0;i<count;i++){
      const el = document.createElement('span');
      el.className = 'petal';
      el.textContent = symbols[Math.floor(Math.random()*symbols.length)];

      const x = Math.floor(Math.random() * w);
      const drift = (Math.random() * 260 - 130).toFixed(0) + "px";
      const rot = (Math.random() * 720 - 360).toFixed(0) + "deg";
      const dur = (Math.random() * 2.6 + 3.2).toFixed(2) + "s";
      const delay = (Math.random() * 0.7).toFixed(2) + "s";
      const size = (Math.random() * 14 + 18).toFixed(0) + "px";

      el.style.setProperty('--x', x + "px");
      el.style.setProperty('--drift', drift);
      el.style.setProperty('--rot', rot);
      el.style.animationDuration = dur;
      el.style.animationDelay = delay;
      el.style.fontSize = size;

      petalsLayer.appendChild(el);
      el.addEventListener('animationend', ()=> el.remove());
    }
  }

  function fireworks(){
    confetti({ particleCount: 90, spread: 85, startVelocity: 48, origin: { y: 0.62 }});
    confetti({ particleCount: 50, spread: 70, startVelocity: 40, origin: { x: 0.25, y: 0.65 }});
    confetti({ particleCount: 50, spread: 70, startVelocity: 40, origin: { x: 0.75, y: 0.65 }});
  }

  function playSfx(){
    // BGMì€ ëŠì§€ ì•Šê³ , íš¨ê³¼ìŒë§Œ ìœ„ì— ê²¹ì³ ì¬ìƒ
    try{
      sfx.currentTime = 0;
      sfx.volume = 0.9;
      sfx.play();
    }catch(e){}
  }

  function yes(){
    // íš¨ê³¼ìŒ + í­ì£½ + ê½ƒ (í˜ì´ì§€ ì „í™˜ ì—†ìŒ)
    playSfx();
    fireworks();
    dropFlowers(45);

    // ë²„íŠ¼ ì¤‘ë³µ í´ë¦­ ë°©ì§€
    yesBtn.classList.add('done');
    yesBtn.textContent = "ğŸ’—";
    yesBtn.disabled = true;
  }

  updateNav();
</script>
</body>
</html>
