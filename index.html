<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover"/>
<title>ìš°ë¦¬ë“¤ì˜ ì´ì•¼ê¸°</title>

<link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/orioncactus/pretendard/dist/web/variable/pretendardvariable.css">

<style>
  :root{
    --bg:#0f0d0c;
    --text:#f5f5f5;
    --muted:rgba(245,245,245,0.72);
    --accent:#ff4d6d;
    --shadow:0 18px 60px rgba(0,0,0,.45);
    --vh:1vh; /* JSì—ì„œ ì‹¤ì œ í™”ë©´ ë†’ì´ë¡œ ê°±ì‹  */
  }

  *{ box-sizing:border-box; }

  body{
    margin:0;
    font-family:"Pretendard Variable", system-ui, -apple-system, BlinkMacSystemFont;
    background:
      radial-gradient(1200px 600px at 50% 70%, rgba(255,77,109,0.16), transparent 60%),
      radial-gradient(800px 500px at 30% 20%, rgba(255,143,171,0.12), transparent 60%),
      var(--bg);
    color:var(--text);
    overflow:hidden;
    touch-action:manipulation;
  }

  /* í˜ì´ì§€: ì£¼ì†Œì°½/íˆ´ë°” í¬í•¨ vh ì˜¤ì°¨ ë°©ì§€ */
  .page{
    position:absolute;
    inset:0;
    height: calc(var(--vh) * 100);
    display:flex;
    flex-direction:column;
    align-items:center;
    justify-content:center;
    gap:8px;
    padding: 0; /* âœ… í”„ë ˆì„ ì œê±° + í™”ë©´ ê½‰ */
    opacity:0;
    transform: translateY(8px) scale(0.985);
    transition: opacity .55s ease, transform .55s ease;
  }
  .page.active{
    opacity:1;
    transform: translateY(0) scale(1);
    z-index:2;
  }

  /* ì»¤ë²„(ì²« í™”ë©´): ì´ë¯¸ì§€ + ë²„íŠ¼ì„ í•˜ë‚˜ë¡œ */
  .cover{
    position:relative;
    width:100%;
    height:100%;
    display:flex;
    align-items:center;
    justify-content:center;
  }

  /* í˜ì´ì§€ ì´ë¯¸ì§€: ìµœëŒ€ í¬ê²Œ */
  .page img{
    width:100%;
    height:100%;
    object-fit:contain;
    display:block;
  }

  /* ì²« í™”ë©´ í„°ì¹˜ ì•ˆë‚´(ì•ˆ ë³´ì´ê²Œ ì²˜ë¦¬) */
  .cover-hit{
    position:absolute;
    inset:0;
    z-index:5;
    background: transparent;
  }

  /* ì‹œì‘í•˜ê¸° ë²„íŠ¼: ì‘ê²Œ, ì´ë¯¸ì§€ ìœ„ì— ì˜¤ë²„ë ˆì´ */
  .start-btn{
    position:absolute;
    bottom: max(18px, env(safe-area-inset-bottom));
    left:50%;
    transform:translateX(-50%);
    padding: 8px 22px;
    font-size: 14px;
    font-weight: 900;
    letter-spacing:-0.02em;
    border:none;
    border-radius:999px;
    background: var(--accent);
    color:white;
    box-shadow:0 12px 24px rgba(255,77,109,.28);
    cursor:pointer;
    z-index:10;
    -webkit-tap-highlight-color: transparent;
  }

  /* í”„ëŸ¬í¬ì¦ˆ ë¬¸êµ¬ */
  .question{
    position:absolute;
    top: max(10px, env(safe-area-inset-top));
    left: 50%;
    transform: translateX(-50%);
    width: 92vw;
    text-align:center;
    font-weight:950;
    letter-spacing:-0.04em;
    line-height:1.1;
    margin:0;
    font-size:22px;
    z-index:10;
    text-shadow: 0 8px 24px rgba(0,0,0,.45);
    pointer-events:none;
  }

  /* Yes ë²„íŠ¼: ì´ë¯¸ì§€ ìœ„ì— ì˜¤ë²„ë ˆì´ */
  .yes-btn{
    position:absolute;
    bottom: max(18px, env(safe-area-inset-bottom));
    left:50%;
    transform:translateX(-50%);
    padding: 10px 26px;
    font-size: 15px;
    font-weight: 900;
    border:none;
    border-radius:999px;
    background: var(--accent);
    color:white;
    box-shadow:0 12px 24px rgba(255,77,109,.28);
    cursor:pointer;
    z-index:10;
    -webkit-tap-highlight-color: transparent;
  }
  .yes-btn.pulse{ animation:pulse 1.5s ease-in-out infinite; }
  @keyframes pulse{ 0%,100%{transform:translateX(-50%) scale(1)} 50%{transform:translateX(-50%) scale(1.03)} }

  /* í•˜ë‹¨ ì´ì „/ë‹¤ìŒ: 2í˜ì´ì§€ë¶€í„°ë§Œ ë³´ì´ê²Œ(í‘œì§€ëŠ” ìˆ¨ê¹€) */
  .bottom-nav{
    position:fixed;
    left:0;
    right:0;
    bottom: max(4px, env(safe-area-inset-bottom));
    display:flex;
    justify-content:center;
    gap:8px;
    padding: 6px 10px;
    z-index:50;
    pointer-events:none;
  }
  .nav-btn{
    pointer-events:auto;
    padding: 8px 12px;
    font-size: 13px;
    font-weight: 900;
    border:none;
    border-radius:999px;
    background: rgba(255,255,255,0.80);
    color:#141414;
    opacity:0.65;
    cursor:pointer;
    user-select:none;
    -webkit-tap-highlight-color:transparent;
  }
  .nav-btn:disabled{ opacity:.28; cursor:not-allowed; }

  body.is-cover .bottom-nav{ display:none; } /* âœ… ì²« í™”ë©´ì— ë„¤ë¹„ ì œê±° */

  /* ê½ƒì */
  .petals{ position:fixed; inset:0; pointer-events:none; z-index:200; }
  .petal{
    position:absolute;
    top:-10vh;
    font-size:22px;
    filter: drop-shadow(0 8px 14px rgba(0,0,0,.25));
    animation: fall linear forwards;
    will-change: transform, opacity;
  }
  @keyframes fall{
    0%{transform:translate3d(var(--x),-10vh,0) rotate(0deg); opacity:0;}
    10%{opacity:1;}
    100%{transform:translate3d(calc(var(--x) + var(--drift)),110vh,0) rotate(var(--rot)); opacity:1;}
  }
</style>

<script>
  function setVH(){
    const vh = window.innerHeight * 0.01;
    document.documentElement.style.setProperty('--vh', `${vh}px`);
  }
  window.addEventListener('resize', setVH);
  window.addEventListener('orientationchange', () => setTimeout(setVH, 200));
  setVH();
</script>
</head>

<body class="is-cover">
<audio id="bgm" src="music.mp3" loop></audio>
<audio id="sfx" src="firework.mp3" preload="auto"></audio>

<!-- 1: í‘œì§€ (ì•„ë¬´ ê³³ í„°ì¹˜í•´ë„ ì‹œì‘í•˜ê¸°) -->
<div class="page active" id="coverPage">
  <div class="cover" id="coverArea">
    <img src="1.png" alt="cover">
    <button class="start-btn" id="startBtn" type="button">ì‹œì‘í•˜ê¸°</button>
    <!-- í™”ë©´ ì „ì²´ í„°ì¹˜ ì˜ì—­ -->
    <div class="cover-hit" aria-hidden="true"></div>
  </div>
</div>

<!-- 2~5 -->
<div class="page"><img src="2.png" alt="p2"></div>
<div class="page"><img src="3.png" alt="p3"></div>
<div class="page"><img src="4.png" alt="p4"></div>
<div class="page"><img src="5.png" alt="p5"></div>

<!-- 6: ë§ˆì§€ë§‰ -->
<div class="page">
  <h2 class="question">ë‚˜ì™€ ê²°í˜¼í•´ì¤„ë˜? ğŸ’ğŸ’</h2>
  <img src="6.png" alt="proposal">
  <button id="yesBtn" class="yes-btn pulse" type="button">Yes!</button>
</div>

<!-- í•˜ë‹¨ ì´ì „/ë‹¤ìŒ -->
<div class="bottom-nav">
  <button id="prevBtn" class="nav-btn" type="button">ì´ì „</button>
  <button id="nextBtn" class="nav-btn" type="button">ë‹¤ìŒ</button>
</div>

<div id="petals" class="petals"></div>

<script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.9.3/dist/confetti.browser.min.js"></script>
<script>
  const pages = document.querySelectorAll('.page');
  const prevBtn = document.getElementById('prevBtn');
  const nextBtn = document.getElementById('nextBtn');
  const petalsLayer = document.getElementById('petals');
  const bgm = document.getElementById('bgm');
  const sfx = document.getElementById('sfx');

  const coverArea = document.getElementById('coverArea');
  const startBtn = document.getElementById('startBtn');
  const yesBtn = document.getElementById('yesBtn');

  let current = 0;

  // ì²« ìƒí˜¸ì‘ìš©: BGM ì‹œì‘ + SFX ì›Œë°ì—… + ì£¼ì†Œì°½ ìˆ¨ê¹€ ì‹œë„
  function firstInteract(){
    if (!bgm.paused) return;
    bgm.play().catch(()=>{});
    try{
      sfx.play().then(()=>{
        sfx.pause();
        sfx.currentTime = 0;
      }).catch(()=>{});
    }catch(e){}
    setTimeout(() => window.scrollTo(0,1), 120);
  }
  document.body.addEventListener('pointerdown', firstInteract, { once:true });

  function updateNav(){
    prevBtn.disabled = current === 0;
    nextBtn.style.display = (current === pages.length - 1) ? 'none' : 'inline-block';
    document.body.classList.toggle('is-cover', current === 0);
  }

  function showPage(i){
    pages[current].classList.remove('active');
    current = i;
    pages[current].classList.add('active');
    updateNav();
    setTimeout(() => window.scrollTo(0,1), 80);
  }

  function nextPage(){
    if(current < pages.length - 1) showPage(current + 1);
  }
  function prevPage(){
    if(current > 0) showPage(current - 1);
  }

  // âœ… ì²« í™”ë©´: ì•„ë¬´ ê³³ í„°ì¹˜í•´ë„ ì‹œì‘í•˜ê¸°
  function startFromCover(){
    firstInteract();
    nextPage();
  }
  coverArea.addEventListener('click', startFromCover);
  startBtn.addEventListener('click', (e)=>{ e.stopPropagation(); startFromCover(); });

  // í•˜ë‹¨ ë„¤ë¹„ ë²„íŠ¼
  prevBtn.addEventListener('click', prevPage);
  nextBtn.addEventListener('click', nextPage);

  function dropFlowers(count = 44){
    const symbols = ["ğŸŒ¸","ğŸŒ·","ğŸ’","ğŸŒº","ğŸŒ¼"];
    const w = window.innerWidth;

    for(let i=0;i<count;i++){
      const el = document.createElement('span');
      el.className = 'petal';
      el.textContent = symbols[Math.floor(Math.random()*symbols.length)];

      const x = Math.floor(Math.random() * w);
      const drift = (Math.random() * 300 - 150).toFixed(0) + "px";
      const rot = (Math.random() * 720 - 360).toFixed(0) + "deg";
      const dur = (Math.random() * 2.2 + 2.8).toFixed(2) + "s";
      const delay = (Math.random() * 0.18).toFixed(2) + "s";
      const size = (Math.random() * 14 + 18).toFixed(0) + "px";

      el.style.setProperty('--x', x + "px");
      el.style.setProperty('--drift', drift);
      el.style.setProperty('--rot', rot);
      el.style.animationDuration = dur;
      el.style.animationDelay = delay;
      el.style.fontSize = size;

      petalsLayer.appendChild(el);
      el.addEventListener('animationend', ()=> el.remove());
    }
  }

  function fireworks(){
    confetti({ particleCount: 110, spread: 95, startVelocity: 52, origin: { y: 0.62 }});
    confetti({ particleCount: 70,  spread: 85, startVelocity: 46, origin: { x: 0.18, y: 0.68 }});
    confetti({ particleCount: 70,  spread: 85, startVelocity: 46, origin: { x: 0.82, y: 0.68 }});
  }

  function playSfxFresh(){
    try{
      sfx.pause();
      sfx.currentTime = 0;
      sfx.volume = 0.95;
      sfx.play();
    }catch(e){}
  }

  // Yes ë°˜ë³µ í´ë¦­: ë§¤ë²ˆ í­ì£½+ê½ƒ+íš¨ê³¼ìŒ ê°±ì‹ 
  function celebrate(){
    playSfxFresh();
    fireworks();
    dropFlowers(44);
  }
  yesBtn.addEventListener('click', celebrate);

  updateNav();

  // PC í…ŒìŠ¤íŠ¸ìš©
  window.addEventListener('keydown', (e)=>{
    if(e.key === 'ArrowRight') nextPage();
    if(e.key === 'ArrowLeft') prevPage();
  });
</script>
</body>
</html>