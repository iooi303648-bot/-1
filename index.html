<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
<title>í˜•ì¤€ì´ì™€ í˜œë¹ˆì´ì˜ ì´ì•¼ê¸°</title>

<!-- ì˜ˆìœ í°íŠ¸: Pretendard (CDN) -->
<link rel="preconnect" href="https://cdn.jsdelivr.net" crossorigin>
<link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/orioncactus/pretendard/dist/web/variable/pretendardvariable.css">

<style>
  :root{
    --bg:#fdf6f0;
    --primary:#ff4d6d;
    --soft:#ff8fab;
    --text:#2b2b2b;
  }

  *{ box-sizing:border-box; }

  body{
    margin:0;
    font-family: "Pretendard Variable", Pretendard, system-ui, -apple-system, "Apple SD Gothic Neo", "Noto Sans KR", sans-serif;
    background: var(--bg);
    color: var(--text);
    overflow:hidden;
  }

  /* ìƒë‹¨ ë„¤ë¹„ */
  .nav{
    position: fixed;
    top: 14px;
    left: 14px;
    right: 14px;
    display:flex;
    justify-content: space-between;
    align-items:center;
    z-index: 50;
    pointer-events:none;
  }

  .nav .btn{
    pointer-events:auto;
    display:inline-flex;
    align-items:center;
    gap:8px;
    padding:10px 14px;
    border-radius: 999px;
    border: 1px solid rgba(0,0,0,0.08);
    background: rgba(255,255,255,0.75);
    backdrop-filter: blur(8px);
    cursor:pointer;
    font-weight: 600;
  }

  .nav .btn:disabled{
    opacity:.45;
    cursor:not-allowed;
  }

  .nav .step{
    pointer-events:none;
    font-size: 13px;
    opacity:.75;
    background: rgba(255,255,255,0.65);
    backdrop-filter: blur(8px);
    border: 1px solid rgba(0,0,0,0.06);
    padding:8px 12px;
    border-radius:999px;
  }

  /* í˜ì´ì§€ */
  .page{
    position:absolute;
    inset:0;
    display:flex;
    justify-content:center;
    align-items:center;
    flex-direction:column;
    gap:16px;
    padding: 70px 16px 22px; /* ìƒë‹¨ ë„¤ë¹„ ê³µê°„ */
    opacity:0;
    transform: translateY(10px) scale(0.98);
    transition: opacity .55s ease, transform .55s ease;
  }

  .page.active{
    opacity:1;
    transform: translateY(0) scale(1);
    z-index:2;
  }

  .frame{
    width:min(900px, 94vw);
    max-height: 78vh;
    display:flex;
    justify-content:center;
    align-items:center;
  }

  img{
    width: 100%;
    max-height: 78vh;
    object-fit: contain;
    border-radius: 16px;
    box-shadow: 0 16px 44px rgba(0,0,0,0.16);
    background: rgba(255,255,255,0.35);
  }

  .title{
    font-size: clamp(18px, 3.5vw, 28px);
    font-weight: 800;
    letter-spacing: -0.02em;
  }

  .sub{
    font-size: 14px;
    opacity: .75;
    margin-top: -6px;
  }

  /* í•˜ë‹¨ ë²„íŠ¼ */
  .action{
    display:flex;
    gap:10px;
    align-items:center;
    justify-content:center;
    margin-top: 6px;
  }

  button.primary{
    padding: 14px 30px;
    font-size: 18px;
    font-weight: 800;
    border:none;
    border-radius: 999px;
    background: var(--soft);
    color:white;
    cursor:pointer;
    box-shadow: 0 10px 26px rgba(255,77,109,0.25);
  }
  button.primary:active{ transform: translateY(1px); }

  button.yes{
    padding: 18px 54px;
    font-size: 24px;
    font-weight: 900;
    background: var(--primary);
    box-shadow: 0 14px 34px rgba(255,77,109,0.28);
  }

  .question{
    text-align:center;
    font-size: clamp(24px, 4.6vw, 38px);
    font-weight: 900;
    letter-spacing: -0.03em;
  }
  .question small{
    display:block;
    font-size: clamp(14px, 2.6vw, 18px);
    font-weight: 700;
    opacity:.7;
    margin-top: 6px;
  }

  /* ì—”ë”© í™”ë©´ */
  .ending{
    position: absolute;
    inset:0;
    display:flex;
    justify-content:center;
    align-items:center;
    text-align:center;
    padding: 24px;
    background: radial-gradient(ellipse at top, rgba(255,255,255,0.9), rgba(255,240,246,0.95));
    opacity:0;
    pointer-events:none;
    transition: opacity .5s ease;
    z-index: 60;
  }

  .ending.show{
    opacity:1;
    pointer-events:auto;
  }

  .ending .msg{
    font-size: clamp(26px, 5.4vw, 44px);
    font-weight: 900;
    letter-spacing: -0.03em;
    line-height: 1.2;
  }
  .ending .hint{
    margin-top: 14px;
    font-size: 14px;
    opacity:.7;
  }

  /* ê½ƒì ë–¨ì–´ì§€ëŠ” ë ˆì´ì–´ */
  .petals{
    position: fixed;
    inset: 0;
    pointer-events: none;
    overflow: hidden;
    z-index: 70;
  }

  .petal{
    position:absolute;
    top:-8vh;
    font-size: 22px;
    will-change: transform, opacity;
    filter: drop-shadow(0 6px 10px rgba(0,0,0,.12));
    animation: fall linear forwards;
    opacity: 0.95;
  }

  @keyframes fall{
    0%   { transform: translate3d(var(--x), -10vh, 0) rotate(0deg); opacity: 0; }
    10%  { opacity: 1; }
    100% { transform: translate3d(calc(var(--x) + var(--drift)), 110vh, 0) rotate(var(--rot)); opacity: 1; }
  }
</style>
</head>

<body>
<audio id="bgm" src="music.mp3" loop></audio>

<div class="nav">
  <button id="prevBtn" class="btn" onclick="prevPage()" disabled>â¬…ï¸ ì´ì „</button>
  <div id="step" class="step">1 / 6</div>
  <button id="nextBtnTop" class="btn" onclick="nextPage()">ë‹¤ìŒ âœ</button>
</div>

<!-- í˜ì´ì§€ 1: í‘œì§€ -->
<div class="page active">
  <div class="title">í˜•ì¤€ì´ì™€ í˜œë¹ˆì´ì˜ ì´ì•¼ê¸°</div>
  <div class="sub">ë²„íŠ¼ì„ ëˆ„ë¥´ë©´ ì±…ì´ ì—´ë ¤ìš”</div>
  <div class="frame"><img src="1.png" alt="cover"></div>
  <div class="action">
    <button class="primary" onclick="nextPage()">ì‹œì‘í•˜ê¸°</button>
  </div>
</div>

<!-- 2~5 -->
<div class="page"><div class="frame"><img src="2.png" alt="p2"></div></div>
<div class="page"><div class="frame"><img src="3.png" alt="p3"></div></div>
<div class="page"><div class="frame"><img src="4.png" alt="p4"></div></div>
<div class="page"><div class="frame"><img src="5.png" alt="p5"></div></div>

<!-- 6: í”„ëŸ¬í¬ì¦ˆ -->
<div class="page">
  <div class="question">
    ë‚˜ì™€ ê²°í˜¼í•´ì¤„ë˜?
    <small>(Will you marry me?)</small>
  </div>
  <div class="frame"><img src="6.png" alt="proposal"></div>
  <div class="action">
    <button class="primary yes" onclick="yes()">Yes!</button>
  </div>
</div>

<!-- ì—”ë”© -->
<div id="ending" class="ending">
  <div>
    <div class="msg">ìš°ë¦¬ ì•ìœ¼ë¡œë„ ê°™ì´ í–‰ë³µí•˜ì ğŸ’ğŸ’</div>
    <div class="hint">í™”ë©´ì„ í•œ ë²ˆ ë” í„°ì¹˜í•˜ë©´ ê½ƒì´ ì¡°ê¸ˆ ë” ë–¨ì–´ì ¸ìš”</div>
  </div>
</div>

<div id="petals" class="petals"></div>

<!-- í­ì£½(ì»¨í˜í‹°) -->
<script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.9.3/dist/confetti.browser.min.js"></script>

<script>
  const pages = document.querySelectorAll('.page');
  const prevBtn = document.getElementById('prevBtn');
  const nextBtnTop = document.getElementById('nextBtnTop');
  const step = document.getElementById('step');
  const bgm = document.getElementById('bgm');
  const ending = document.getElementById('ending');
  const petalsLayer = document.getElementById('petals');

  let current = 0;
  let ended = false;

  // ëª¨ë°”ì¼ ìë™ì¬ìƒ ì œí•œ ëŒ€ì‘: ì²« ìƒí˜¸ì‘ìš© ë•Œ ìŒì•… ì¬ìƒ
  document.body.addEventListener('pointerdown', () => {
    if (!bgm.paused) return;
    bgm.play().catch(()=>{});
  }, { once: true });

  function updateNav(){
    prevBtn.disabled = (current === 0 || ended);
    nextBtnTop.style.visibility = ended ? 'hidden' : 'visible';
    step.textContent = `${Math.min(current+1, pages.length)} / ${pages.length}`;
    // ë§ˆì§€ë§‰ í˜ì´ì§€ì—ì„œëŠ” ìƒë‹¨ ë‹¤ìŒ ë²„íŠ¼ ìˆ¨ê¹€(ì¤‘ë³µ ë°©ì§€)
    if (current === pages.length - 1) nextBtnTop.style.visibility = 'hidden';
  }

  function showPage(idx){
    pages[current].classList.remove('active');
    current = idx;
    pages[current].classList.add('active');
    updateNav();
  }

  function nextPage(){
    if (ended) return;
    if (current < pages.length - 1) showPage(current + 1);
  }

  function prevPage(){
    if (ended) return;
    if (current > 0) showPage(current - 1);
  }

  // í‚¤ë³´ë“œë„ ì§€ì›(PC)
  window.addEventListener('keydown', (e)=>{
    if (e.key === 'ArrowRight') nextPage();
    if (e.key === 'ArrowLeft') prevPage();
  });

  function burstFireworks(){
    // ê°€ìš´ë°/ì–‘ìª½ìœ¼ë¡œ ì—°ì† í­ì£½
    const duration = 1200;
    const end = Date.now() + duration;

    (function frame() {
      confetti({
        particleCount: 6,
        spread: 70,
        startVelocity: 45,
        origin: { x: 0.2, y: 0.7 }
      });
      confetti({
        particleCount: 6,
        spread: 70,
        startVelocity: 45,
        origin: { x: 0.8, y: 0.7 }
      });
      confetti({
        particleCount: 10,
        spread: 90,
        startVelocity: 55,
        origin: { x: 0.5, y: 0.55 }
      });

      if (Date.now() < end) requestAnimationFrame(frame);
    })();
  }

  function dropFlowers(count = 26){
    const symbols = ["ğŸŒ¸","ğŸŒ·","ğŸ’","ğŸŒº","ğŸŒ¼"];
    const w = window.innerWidth;

    for (let i=0; i<count; i++){
      const el = document.createElement('span');
      el.className = 'petal';
      el.textContent = symbols[Math.floor(Math.random()*symbols.length)];

      const x = Math.floor(Math.random() * w);
      const drift = (Math.random() * 260 - 130).toFixed(0) + "px";
      const rot = (Math.random() * 720 - 360).toFixed(0) + "deg";
      const dur = (Math.random() * 2.6 + 3.2).toFixed(2) + "s";
      const delay = (Math.random() * 0.8).toFixed(2) + "s";
      const size = (Math.random() * 14 + 18).toFixed(0) + "px";

      el.style.setProperty('--x', x + "px");
      el.style.setProperty('--drift', drift);
      el.style.setProperty('--rot', rot);
      el.style.animationDuration = dur;
      el.style.animationDelay = delay;
      el.style.fontSize = size;

      petalsLayer.appendChild(el);
      el.addEventListener('animationend', ()=> el.remove());
    }
  }

  function yes(){
    ended = true;
    updateNav();

    // ìŒì•…ì€ ê³„ì† ì¬ìƒ(ì›í•˜ë©´ ì—¬ê¸°ì„œ ë°”ê¿”ë„ ë¨)
    // bgm.volume = 0.9;

    // ìƒí˜¸ì‘ìš©: í­ì£½ + ê½ƒ
    burstFireworks();
    dropFlowers(40);

    // ì—”ë”© ë¬¸êµ¬ ê°€ìš´ë° ì •ë ¬ë¡œ í‘œì‹œ
    ending.classList.add('show');
  }

  // ì—”ë”© í™”ë©´ì—ì„œ ì¶”ê°€ ì¸í„°ë™ì…˜: í„°ì¹˜í•˜ë©´ ê½ƒ ë” ë–¨ì–´ì§
  ending.addEventListener('pointerdown', () => {
    burstFireworks();
    dropFlowers(22);
  });

  // ì´ˆê¸° ë„¤ë¹„ í‘œì‹œ
  updateNav();
</script>
</body>
</html>
