<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover"/>
<title>í˜•ì¤€ì´ì™€ í˜œë¹ˆì´ì˜ ì´ì•¼ê¸°</title>

<link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/orioncactus/pretendard/dist/web/variable/pretendardvariable.css">

<style>
  :root{
    --bg: #0f0d0c;
    --card: rgba(255,255,255,0.06);
    --text: #f5f5f5;
    --muted: rgba(245,245,245,0.75);
    --accent: #ff4d6d;
    --accent2:#ff8fab;
    --shadow: 0 18px 60px rgba(0,0,0,.45);
    --radius: 16px;

    /* JSì—ì„œ ì‹¤ì œ í™”ë©´ ë†’ì´ë¡œ ì£¼ì… */
    --vh: 1vh;
  }

  *{ box-sizing:border-box; }

  body{
    margin:0;
    font-family:"Pretendard Variable", system-ui, -apple-system, BlinkMacSystemFont;
    background: radial-gradient(1200px 600px at 50% 70%, rgba(255,77,109,0.18), transparent 60%),
                radial-gradient(800px 500px at 30% 20%, rgba(255,143,171,0.14), transparent 60%),
                var(--bg);
    color: var(--text);
    overflow:hidden;
    touch-action: manipulation;
  }

  /* ====== í˜ì´ì§€ ì»¨í…Œì´ë„ˆ (ì£¼ì†Œì°½/íˆ´ë°” í”¼í•´ ì‹¤ì œ ë†’ì´ ì‚¬ìš©) ====== */
  .page{
    position:absolute;
    inset:0;
    height: calc(var(--vh) * 100);
    display:flex;
    flex-direction:column;
    align-items:center;
    justify-content:center;
    gap:12px;
    padding: 14px 14px 86px; /* í•˜ë‹¨ ë²„íŠ¼ ê³µê°„ */
    opacity:0;
    transform: translateY(8px) scale(0.985);
    transition: opacity .55s ease, transform .55s ease;
  }
  .page.active{
    opacity:1;
    transform: translateY(0) scale(1);
    z-index:2;
  }

  /* ====== ê°€ë¡œ ëª¨ë“œ ìµœì í™” (Z Flip 6 í¬í•¨) ====== */
  @media (orientation: landscape){
    .page{
      padding: 10px 14px 74px;
      gap: 10px;
    }
  }

  /* ====== ì¹´ë“œ í”„ë ˆì„ ====== */
  .frame{
    width: min(980px, 96vw);
    height: min(calc(var(--vh) * 82), 78vh);
    display:flex;
    align-items:center;
    justify-content:center;
    background: linear-gradient(180deg, rgba(255,255,255,0.08), rgba(255,255,255,0.03));
    border: 1px solid rgba(255,255,255,0.10);
    border-radius: var(--radius);
    box-shadow: var(--shadow);
    overflow:hidden;
  }

  img{
    width: 100%;
    height: 100%;
    object-fit: contain;
    display:block;
  }

  .title{
    font-weight: 900;
    letter-spacing: -0.03em;
    text-align:center;
    font-size: 18px;
    color: var(--text);
    margin: 0;
  }
  .sub{
    margin: 0;
    font-size: 13px;
    color: var(--muted);
    text-align:center;
  }

  .question{
    font-weight: 950;
    letter-spacing: -0.04em;
    text-align:center;
    line-height: 1.1;
    margin: 0;
    font-size: 26px;
  }

  @media (orientation: landscape){
    .title{ font-size: 16px; }
    .sub{ font-size: 12px; }
    .question{ font-size: 24px; }
  }

  /* ====== í•˜ë‹¨ ë„¤ë¹„: ì£¼ì†Œ/íˆ´ë°” í”¼í•´ ì•ˆì „í•˜ê²Œ ====== */
  .bottom-nav{
    position:fixed;
    left:0;
    right:0;
    bottom: max(12px, env(safe-area-inset-bottom));
    display:flex;
    justify-content:center;
    gap:10px;
    padding: 10px 12px;
    z-index:50;
    pointer-events:none; /* ë°” ì „ì²´ëŠ” í´ë¦­ ë°©ì§€, ë²„íŠ¼ë§Œ í—ˆìš© */
  }

  .nav-btn, .start-btn, .yes-btn{
    pointer-events:auto;
    border:none;
    border-radius: 999px;
    font-weight: 900;
    letter-spacing: -0.02em;
    cursor:pointer;
    user-select:none;
    -webkit-tap-highlight-color: transparent;
  }

  .nav-btn{
    padding: 12px 18px;
    font-size: 15px;
    background: rgba(255,255,255,0.86);
    color: #141414;
  }
  .nav-btn:disabled{
    opacity: .45;
    cursor:not-allowed;
  }

  .start-btn, .yes-btn{
    padding: 14px 34px;
    font-size: 18px;
    background: var(--accent);
    color: white;
    box-shadow: 0 14px 34px rgba(255,77,109,.35);
  }

  /* ê°€ë¡œ ëª¨ë“œì—ì„  ë²„íŠ¼ì´ ì‚´ì§ ë” ë‚®ê²Œ + ì¡°ê¸ˆ ì‘ê²Œ */
  @media (orientation: landscape){
    .nav-btn{ padding: 10px 16px; font-size: 14px; }
    .start-btn, .yes-btn{ padding: 12px 30px; font-size: 16px; }
  }

  /* Yes ë²„íŠ¼ ë°˜ë³µ í´ë¦­ ìœ ë„(ì€ì€í•œ ë§¥ë°•) */
  .yes-btn.pulse{
    animation: pulse 1.5s ease-in-out infinite;
  }
  @keyframes pulse{
    0%,100%{ transform:scale(1); }
    50%{ transform:scale(1.03); }
  }

  /* ====== ê½ƒì ====== */
  .petals{
    position:fixed;
    inset:0;
    pointer-events:none;
    z-index:200;
  }
  .petal{
    position:absolute;
    top:-10vh;
    font-size:22px;
    filter: drop-shadow(0 8px 14px rgba(0,0,0,.25));
    animation: fall linear forwards;
    will-change: transform, opacity;
  }
  @keyframes fall{
    0%   { transform: translate3d(var(--x), -10vh, 0) rotate(0deg); opacity:0; }
    10%  { opacity:1; }
    100% { transform: translate3d(calc(var(--x) + var(--drift)), 110vh, 0) rotate(var(--rot)); opacity:1; }
  }

  /* ====== ìƒë‹¨ì˜ ë¸Œë¼ìš°ì € ë°” ê°€ë¦´ ìˆ˜ëŠ” ì—†ì§€ë§Œ, ì‹œê°ì  ì—¬ë°± ìµœì†Œí™” ====== */
  .tap-hint{
    position: fixed;
    top: 10px;
    left: 10px;
    right: 10px;
    z-index: 5;
    display:flex;
    justify-content:center;
    pointer-events:none;
    opacity:.0; /* ê¸°ë³¸ ìˆ¨ê¹€ */
  }
</style>

<script>
  // ëª¨ë°”ì¼ ë¸Œë¼ìš°ì € ì£¼ì†Œ/íˆ´ë°” ë•Œë¬¸ì— vhê°€ í‹€ì–´ì§€ëŠ” ë¬¸ì œ í•´ê²°
  function setVH(){
    const vh = window.innerHeight * 0.01;
    document.documentElement.style.setProperty('--vh', `${vh}px`);
  }
  window.addEventListener('resize', setVH);
  window.addEventListener('orientationchange', () => setTimeout(setVH, 200));
  setVH();
</script>
</head>

<body>
<!-- ë°°ê²½ìŒì•… -->
<audio id="bgm" src="music.mp3" loop></audio>
<!-- í­ì£½ íš¨ê³¼ìŒ -->
<audio id="sfx" src="firework.mp3" preload="auto"></audio>

<div class="tap-hint"></div>

<!-- 1: í‘œì§€ -->
<div class="page active">
  <h1 class="title">ì„¸ìƒì—ì„œ ê°€ì¥ ë”°ëœ»í•œ ë™í™”: ìš°ë¦¬ë“¤ì˜ ì´ì•¼ê¸°</h1>
  <p class="sub">ê°€ë¡œ í™”ë©´ì— ìµœì í™”ë˜ì–´ ìˆì–´ìš”</p>
  <div class="frame"><img src="1.png" alt="cover"></div>
  <button class="start-btn" onclick="nextPage()">ì‹œì‘í•˜ê¸°</button>
</div>

<!-- 2~5 -->
<div class="page"><div class="frame"><img src="2.png" alt="p2"></div></div>
<div class="page"><div class="frame"><img src="3.png" alt="p3"></div></div>
<div class="page"><div class="frame"><img src="4.png" alt="p4"></div></div>
<div class="page"><div class="frame"><img src="5.png" alt="p5"></div></div>

<!-- 6: ë§ˆì§€ë§‰(í”„ëŸ¬í¬ì¦ˆ) -->
<div class="page">
  <h2 class="question">ë‚˜ì™€ ê²°í˜¼í•´ì¤„ë˜? ğŸ’ğŸ’</h2>
  <div class="frame"><img src="6.png" alt="proposal"></div>
  <button id="yesBtn" class="yes-btn pulse" onclick="celebrate()">Yes!</button>
</div>

<!-- í•˜ë‹¨ ì´ì „/ë‹¤ìŒ -->
<div class="bottom-nav">
  <button id="prevBtn" class="nav-btn" onclick="prevPage()" disabled>ì´ì „</button>
  <button id="nextBtn" class="nav-btn" onclick="nextPage()">ë‹¤ìŒ</button>
</div>

<div id="petals" class="petals"></div>

<script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.9.3/dist/confetti.browser.min.js"></script>
<script>
  const pages = document.querySelectorAll('.page');
  const prevBtn = document.getElementById('prevBtn');
  const nextBtn = document.getElementById('nextBtn');
  const petalsLayer = document.getElementById('petals');
  const bgm = document.getElementById('bgm');
  const sfx = document.getElementById('sfx');
  const yesBtn = document.getElementById('yesBtn');

  let current = 0;

  // ì²« í„°ì¹˜ì—ì„œ BGM ì‹œì‘ + SFX ì›Œë°ì—… + ì£¼ì†Œì°½ ì‚´ì§ ìˆ¨ê¹€ ì‹œë„
  document.body.addEventListener('pointerdown', async () => {
    if (bgm.paused) bgm.play().catch(()=>{});

    try {
      await sfx.play();
      sfx.pause();
      sfx.currentTime = 0;
    } catch(e) {}

    // ì£¼ì†Œì°½ ìˆ¨ê¹€ íŠ¸ë¦­(ë¸Œë¼ìš°ì €ì— ë”°ë¼ íš¨ê³¼)
    setTimeout(() => window.scrollTo(0, 1), 120);
  }, { once: true });

  function updateNav(){
    prevBtn.disabled = current === 0;
    nextBtn.style.display = (current === pages.length - 1) ? 'none' : 'inline-block';
  }

  function showPage(i){
    pages[current].classList.remove('active');
    current = i;
    pages[current].classList.add('active');
    updateNav();

    // í˜ì´ì§€ ì´ë™ í›„ ì£¼ì†Œì°½ ìˆ¨ê¹€ íŠ¸ë¦­ ì¬ì‹œë„
    setTimeout(() => window.scrollTo(0, 1), 80);
  }

  function nextPage(){ if(current < pages.length - 1) showPage(current + 1); }
  function prevPage(){ if(current > 0) showPage(current - 1); }

  function dropFlowers(count = 42){
    const symbols = ["ğŸŒ¸","ğŸŒ·","ğŸ’","ğŸŒº","ğŸŒ¼"];
    const w = window.innerWidth;

    for(let i=0;i<count;i++){
      const el = document.createElement('span');
      el.className = 'petal';
      el.textContent = symbols[Math.floor(Math.random()*symbols.length)];

      const x = Math.floor(Math.random() * w);
      const drift = (Math.random() * 300 - 150).toFixed(0) + "px";
      const rot = (Math.random() * 720 - 360).toFixed(0) + "deg";
      const dur = (Math.random() * 2.2 + 2.8).toFixed(2) + "s";   // ê°€ë¡œì—ì„œ ë” ê²½ì¾Œí•˜ê²Œ
      const delay = (Math.random() * 0.22).toFixed(2) + "s";
      const size = (Math.random() * 14 + 18).toFixed(0) + "px";

      el.style.setProperty('--x', x + "px");
      el.style.setProperty('--drift', drift);
      el.style.setProperty('--rot', rot);
      el.style.animationDuration = dur;
      el.style.animationDelay = delay;
      el.style.fontSize = size;

      petalsLayer.appendChild(el);
      el.addEventListener('animationend', ()=> el.remove());
    }
  }

  function fireworks(){
    // ê°€ë¡œ í™”ë©´ì— ë§ì¶° ë„“ê²Œ í¼ì§€ëŠ” ëŠë‚Œ
    confetti({ particleCount: 110, spread: 95, startVelocity: 52, origin: { y: 0.62 }});
    confetti({ particleCount: 70,  spread: 85, startVelocity: 46, origin: { x: 0.18, y: 0.68 }});
    confetti({ particleCount: 70,  spread: 85, startVelocity: 46, origin: { x: 0.82, y: 0.68 }});
  }

  function playSfxFresh(){
    // ë§¤ë²ˆ ì²˜ìŒë¶€í„° ì¬ìƒ(ê°±ì‹ )
    try{
      sfx.pause();
      sfx.currentTime = 0;
      sfx.volume = 0.95;
      sfx.play();
    }catch(e){}
  }

  // YesëŠ” ë°˜ë³µ í´ë¦­ ê°€ëŠ¥: ë§¤ë²ˆ í­ì£½+ê½ƒ+íš¨ê³¼ìŒ
  function celebrate(){
    playSfxFresh();
    fireworks();
    dropFlowers(44);
  }

  // ì´ˆê¸°
  updateNav();

  // í‚¤ë³´ë“œ(PC í…ŒìŠ¤íŠ¸ìš©)
  window.addEventListener('keydown', (e)=>{
    if(e.key === 'ArrowRight') nextPage();
    if(e.key === 'ArrowLeft') prevPage();
  });
</script>
</body>
</html>